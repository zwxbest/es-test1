version: "3"

services:
    nizouba_mysql:
        image: mysql:5.7.17
        ports:
            - "3307:3307"
        volumes:
            - "./docker-mysql/share/:/share/"
            - "./docker-mysql/db/:/docker-entrypoint-initdb.d/:ro"
            - "./docker-mysql/master/lib/:/var/lib/mysql/"
            - "./docker-mysql/master/log/:/var/log/mysql/"
            - "./docker-mysql/master/conf.d/:/etc/mysql/mysql.conf.d/"
        environment:
            - TZ=Asia/Shanghai
            - MYSQL_ROOT_PASSWORD=123456
    xunwu:
        build: .
        image: nizouba/xunwu
        ports:
            - "8080:8080"
        healthcheck:
           test: ["CMD", "curl", "-f", "http://127.0.0.1:8080/hello"]
           interval: 10s
           timeout: 5s
           retries: 3
        environment:
            - TZ=Asia/Shanghai